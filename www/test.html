<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Type" charset="utf-8">
<link rel="stylesheet" href="zarafaadmin.css">

<!-- https://jqueryui.com/datepicker/ -->
<link rel="stylesheet" href="jquery-ui.css">
<script src="jquery-1.10.2.js"></script>
<script src="jquery-ui.js"></script>
<script>
$(function() {
  $( "#ooo-from" ).datepicker({ dateFormat: 'dd-mm-yy' });
  $( "#ooo-until" ).datepicker({ dateFormat: 'dd-mm-yy' });
});

function setMode() {
    var mode = document.getElementById("ooo-mode").value;
    if (mode == 1) {
			document.getElementById("ooo-from").disabled = false;
			document.getElementById("ooo-until").disabled = false;
			document.getElementById("ooo-subject").disabled = false;
			document.getElementById("ooo-message").disabled = false;
			document.getElementById("ooo-from").style.backgroundColor = "white";
			document.getElementById("ooo-until").style.backgroundColor = "white";
			document.getElementById("ooo-subject").style.backgroundColor = "white";
			document.getElementById("ooo-message").style.backgroundColor = "white";
			document.getElementById("ooo-mode").style.color = "green";

    } else {
			document.getElementById("ooo-from").disabled = true;
			document.getElementById("ooo-until").disabled = true;
			document.getElementById("ooo-subject").disabled = true;
			document.getElementById("ooo-message").disabled = true;
			document.getElementById("ooo-from").style.backgroundColor = "lightgrey";
			document.getElementById("ooo-until").style.backgroundColor = "lightgrey";
			document.getElementById("ooo-subject").style.backgroundColor = "lightgrey";
			document.getElementById("ooo-message").style.backgroundColor = "lightgrey";
			document.getElementById("ooo-subject").value = "";
			document.getElementById("ooo-message").value = "";
			document.getElementById("ooo-mode").style.color = "red";			
    }
}
</script>

<title>Zarafa (Un)Set Out of Office</title>
<body onload="setMode()">
<form>
<table>
	<tr>
		<td colspan="5" align="center">Set/Unset Out-of-Office for FullName (emailaddress)</td>
	</tr>
	<tr>
		<td>
			<select name="mode" id="ooo-mode" style="width: 100%;" onchange="setMode()">
			  <option value="0" selected="selected">Disable Out-of-Office</option>
			  <option value="1"> Enable Out-of-Office</option>
			</select>
		</td>
		<td align="right">From:</td>
		<td><input id="ooo-from" name="from"/></td>
		<td align="right">Until:</td>
		<td><input id="ooo-until" name="until"/></td>
	</tr>
	<tr>
		<td align="right" colspan="2">Subject:</td>
		<td colspan="3"><input type="text" name="subject" id="ooo-subject" style="width: 100%;"/></td>
	</tr>
	<tr>
		<td colspan="5" align="left">AutoReply only once to each sender with the following text:</td>
	</tr>
	<tr>
		<td colspan="5">
			<textarea rows="4" cols="50" name="message" id="ooo-message" style="width: 100%; resize: none;"></textarea>
		</td>
	</tr>
	<tr>
		<td align="left"><input id="ooo-cancel" type="button" value="Cancel"/></td>
		<td colspan="3"></td>
		<td align="right"><input id="ooo-submit" type="submit" value="Submit"/></td>		
	</tr>	
</table>
</form>


</body></html>